<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Twitter OAuth Callback</title>
  <script>
    // Function to parse URL query parameters
    function parseQueryString(url) {
      var params = {};
      var queryString = url.split('?')[1];
      var pairs = queryString.split('&');
      for (var i = 0; i < pairs.length; i++) {
        var pair = pairs[i].split('=');
        params[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1] || '');
      }
      return params;
    }

    // Main function to handle OAuth callback
    function handleCallback() {
      var params = parseQueryString(window.location.href);

      if (params.oauth_token && params.oauth_verifier) {
        // Send tokens back to React Native app using postMessage
        window.opener.postMessage({ oauth_token: params.oauth_token, oauth_verifier: params.oauth_verifier }, '*');
        window.close();
      } else {
        console.error('Missing OAuth tokens in callback URL');
        alert('Failed to process authentication. Please try again.');
        window.close();
      }
    }

    // Call handleCallback on page load
    window.onload = function () {
      handleCallback();
    };
  </script>
</head>
<body>
  <h1>Twitter OAuth Callback Page</h1>
  <p>Please wait while we process your request...</p>
</body>
</html>
